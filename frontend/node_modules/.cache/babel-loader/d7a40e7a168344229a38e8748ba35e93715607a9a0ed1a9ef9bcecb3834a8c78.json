{"ast":null,"code":"import{useState,useEffect}from\"react\";import{useDispatch}from'react-redux';import{logout as logoutAction}from'./store/authSlice';import{useLocation,useNavigate}from'react-router-dom';import api from\"./lib/api\";import UserList from\"./components/UserList\";import AddUser from\"./components/AddUser\";import ProfileView from\"./components/ProfileView\";import ProfileForm from\"./components/ProfileForm\";import AdminUserList from\"./components/AdminUserList\";import AdminLogViewer from\"./components/AdminLogViewer\";import HoverMenu from\"./components/HoverMenu\";import Register from\"./components/Register\";import Login from\"./components/Login\";import ForgotPassword from\"./components/ForgotPassword\";import ResetPassword from\"./components/ResetPassword\";import ForgotPasswordLink from\"./components/ForgotPasswordLink\";import ResetPasswordByToken from\"./components/ResetPasswordByToken\";import ChangePasswordAdmin from\"./components/ChangePasswordAdmin\";import AuthHeader from\"./components/AuthHeader\";import{useToast}from\"./components/Toast\";import{useConfirm}from\"./components/ConfirmDialog\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function App(){const location=useLocation();const navigate=useNavigate();const dispatch=useDispatch();const[reloadKey,setReloadKey]=useState(0);const[editUser,setEditUser]=useState(null);const[user,setUser]=useState(()=>{try{return JSON.parse(localStorage.getItem(\"auth_user\"))||null;}catch(e){return null;}});const[view,setView]=useState(user?\"app\":\"login\");// 'app' | 'login' | 'register' | 'forgot' | 'reset' | 'forgot-link' | 'reset-link'\nconst[resetToken,setResetToken]=useState(\"\");const[resetEmail,setResetEmail]=useState(\"\");const[selectedUser,setSelectedUser]=useState(null);// for admin viewing others\nconst[mode,setMode]=useState('profile');// 'profile' | 'profile-edit' | 'change-password' | 'logs'\nconst[editTarget,setEditTarget]=useState('self');// 'self' | 'selected'\nconst[listRefreshKey,setListRefreshKey]=useState(0);useEffect(()=>{if(user)setView(\"app\");},[user]);// Route guarding inside App (in addition to ProtectedRoute)\nuseEffect(()=>{const pathname=location.pathname||'/';const needsAuth=pathname==='/profile'||pathname==='/admin';if(needsAuth&&!user){navigate('/login',{replace:true,state:{from:pathname}});}},[location.pathname,user,navigate]);// On app mount, if token exists, verify and load user from /auth/me\nuseEffect(()=>{const token=localStorage.getItem(\"auth_token\");if(!token)return;(async()=>{try{const res=await api.get('/auth/me');setUser(res.data);setView('app');}catch(e){// invalid token handled by interceptor; ensure state reflects logged out\nsetUser(null);setView('login');navigate('/login',{replace:true});}})();},[navigate]);// Detect reset token from URL to open reset-by-token view directly\nuseEffect(()=>{if(user)return;const params=new URLSearchParams(window.location.search);const t=params.get('resetToken')||params.get('token');if(t){setResetToken(t);setView('reset-link');}},[user]);const handleEdit=u=>setEditUser(u);const handleCancelEdit=()=>setEditUser(null);const handleAdded=()=>{setReloadKey(k=>k+1);setEditUser(null);};const handleLogout=()=>{localStorage.removeItem(\"auth_token\");localStorage.removeItem(\"auth_user\");setUser(null);setView(\"login\");dispatch(logoutAction());navigate('/login',{replace:true});};const toast=(useToast===null||useToast===void 0?void 0:useToast())||null;const confirm=useConfirm===null||useConfirm===void 0?void 0:useConfirm();const handleDeleteSelf=async()=>{const ok=await(confirm?confirm(\"B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a t√†i kho·∫£n? H√†nh ƒë·ªông n√†y kh√¥ng th·ªÉ ho√†n t√°c.\"):Promise.resolve(window.confirm(\"B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a t√†i kho·∫£n? H√†nh ƒë·ªông n√†y kh√¥ng th·ªÉ ho√†n t√°c.\")));if(!ok)return;try{var _toast$success;await api.delete('/auth/me');toast===null||toast===void 0?void 0:(_toast$success=toast.success)===null||_toast$success===void 0?void 0:_toast$success.call(toast,'ƒê√£ x√≥a t√†i kho·∫£n');handleLogout();}catch(e){var _toast$error,_e$response,_e$response$data;toast===null||toast===void 0?void 0:(_toast$error=toast.error)===null||_toast$error===void 0?void 0:_toast$error.call(toast,(e===null||e===void 0?void 0:(_e$response=e.response)===null||_e$response===void 0?void 0:(_e$response$data=_e$response.data)===null||_e$response$data===void 0?void 0:_e$response$data.message)||'X√≥a t√†i kho·∫£n th·∫•t b·∫°i');}};const handleLoggedIn=u=>{var _location$state;setUser(u);setView(\"app\");// Navigate based on role if current path is auth pages\nconst path=(u===null||u===void 0?void 0:u.role)==='admin'?'/admin':'/profile';const from=(_location$state=location.state)===null||_location$state===void 0?void 0:_location$state.from;navigate(from&&from!=='/login'?from:path,{replace:true});};return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"User Portal\"}),/*#__PURE__*/_jsx(\"span\",{className:\"badge\",children:\"MongoDB \\xB7 Express \\xB7 React\"})]}),user&&/*#__PURE__*/_jsx(HoverMenu,{user:user,onLogout:handleLogout,onEditProfile:()=>{setEditTarget('self');setMode('profile-edit');},onChangePassword:()=>{setEditTarget('self');setMode('change-password');},isChangePasswordMode:user.role==='admin'&&mode==='change-password',isProfileEditMode:user.role!=='admin'&&mode==='profile-edit',onGoHome:()=>{setMode('profile');setEditTarget('self');},onDeleteSelf:handleDeleteSelf}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:16},children:[!user&&/*#__PURE__*/_jsx(\"div\",{className:\"card\",style:{padding:18},children:/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',gap:20},children:/*#__PURE__*/_jsx(\"div\",{style:{flex:1},children:view===\"login\"?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"card__header\",children:\"\\u0110\\u0103ng nh\\u1EADp\"}),/*#__PURE__*/_jsx(\"div\",{className:\"card__body\",children:/*#__PURE__*/_jsx(Login,{onLoggedIn:handleLoggedIn,onForgot:()=>setView('forgot')})}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:12,display:'flex',justifyContent:'center',gap:8},children:[/*#__PURE__*/_jsx(\"button\",{className:\"button button--ghost\",onClick:()=>setView('register'),children:\"T\\u1EA1o t\\xE0i kho\\u1EA3n\"}),/*#__PURE__*/_jsx(\"button\",{className:\"button button--ghost\",onClick:()=>setView('forgot'),children:\"Qu\\xEAn m\\u1EADt kh\\u1EA9u (OTP)\"}),/*#__PURE__*/_jsx(\"button\",{className:\"button button--ghost\",onClick:()=>setView('forgot-link'),children:\"Qu\\xEAn m\\u1EADt kh\\u1EA9u (link)\"})]})]}):view==='register'?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"card__header\",children:\"\\u0110\\u0103ng k\\xFD\"}),/*#__PURE__*/_jsx(\"div\",{className:\"card__body\",children:/*#__PURE__*/_jsx(Register,{onRegistered:()=>setView('login')})}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:12},children:/*#__PURE__*/_jsx(\"button\",{className:\"button button--ghost\",onClick:()=>setView('login'),children:\"\\u0110\\xE3 c\\xF3 t\\xE0i kho\\u1EA3n? \\u0110\\u0103ng nh\\u1EADp\"})})]}):view==='forgot'?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"card__header\",children:\"Qu\\xEAn m\\u1EADt kh\\u1EA9u\"}),/*#__PURE__*/_jsx(\"div\",{className:\"card__body\",children:/*#__PURE__*/_jsx(ForgotPassword,{onRequested:email=>{setResetEmail(email);setView('reset');}})}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:12},children:/*#__PURE__*/_jsx(\"button\",{className:\"button button--ghost\",onClick:()=>setView('login'),children:\"Quay l\\u1EA1i \\u0111\\u0103ng nh\\u1EADp\"})})]}):view==='reset'?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"card__header\",children:\"Nh\\u1EADp OTP v\\xE0 m\\u1EADt kh\\u1EA9u m\\u1EDBi\"}),/*#__PURE__*/_jsx(\"div\",{className:\"card__body\",children:/*#__PURE__*/_jsx(ResetPassword,{defaultEmail:resetEmail,onDone:()=>setView('login')})}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:12},children:/*#__PURE__*/_jsx(\"button\",{className:\"button button--ghost\",onClick:()=>setView('login'),children:\"Quay l\\u1EA1i \\u0111\\u0103ng nh\\u1EADp\"})})]}):view==='forgot-link'?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"card__header\",children:\"Qu\\xEAn m\\u1EADt kh\\u1EA9u (nh\\u1EADn link qua email)\"}),/*#__PURE__*/_jsx(\"div\",{className:\"card__body\",children:/*#__PURE__*/_jsx(ForgotPasswordLink,{onRequested:()=>{/* stay here, user ki·ªÉm tra email */}})}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:12,display:'flex',gap:8},children:[/*#__PURE__*/_jsx(\"button\",{className:\"button button--ghost\",onClick:()=>setView('login'),children:\"Quay l\\u1EA1i \\u0111\\u0103ng nh\\u1EADp\"}),/*#__PURE__*/_jsx(\"button\",{className:\"button button--ghost\",onClick:()=>setView('forgot'),children:\"\\u0110\\u1ED5i sang OTP\"})]})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"card__header\",children:\"\\u0110\\u1EB7t l\\u1EA1i m\\u1EADt kh\\u1EA9u t\\u1EEB link\"}),/*#__PURE__*/_jsx(\"div\",{className:\"card__body\",children:/*#__PURE__*/_jsx(ResetPasswordByToken,{defaultToken:resetToken,onDone:()=>setView('login')})}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:12},children:/*#__PURE__*/_jsx(\"button\",{className:\"button button--ghost\",onClick:()=>setView('login'),children:\"Quay l\\u1EA1i \\u0111\\u0103ng nh\\u1EADp\"})})]})})})}),user&&/*#__PURE__*/_jsxs(_Fragment,{children:[user.role!=='admin'&&/*#__PURE__*/_jsx(\"div\",{className:\"grid\",style:{gridTemplateColumns:'1fr'},children:mode==='profile'?/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card__header\",children:\"H\\u1ED3 s\\u01A1 c\\u1EE7a t\\xF4i\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"card__body\",children:[/*#__PURE__*/_jsx(ProfileView,{user:user}),/*#__PURE__*/_jsx(\"div\",{className:\"empty\",style:{marginTop:12},children:\"\\u0110\\u1EC3 c\\u1EADp nh\\u1EADt th\\xF4ng tin, m\\u1EDF menu b\\xEAn ph\\u1EA3i v\\xE0 ch\\u1ECDn \\\"C\\u1EADp nh\\u1EADt th\\xF4ng tin\\\"\"})]})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card__header\",children:\"C\\u1EADp nh\\u1EADt th\\xF4ng tin c\\xE1 nh\\xE2n\"}),/*#__PURE__*/_jsx(\"div\",{className:\"card__body\",children:/*#__PURE__*/_jsx(ProfileForm,{initialUser:user,allowSelfChangePassword:true,focusChangePassword:false,onSaved:async()=>{try{const res=await api.get('/auth/me');setUser(res.data);}catch(_unused){}setMode('profile');}})})]})}),user.role==='admin'&&(mode==='change-password'?/*#__PURE__*/// Separate page: only the Change Password card, no account list\n_jsx(\"div\",{className:\"grid\",style:{gridTemplateColumns:'1fr'},children:/*#__PURE__*/_jsx(ChangePasswordAdmin,{})}):mode==='logs'?/*#__PURE__*/// Separate page: Logs viewer\n_jsx(\"div\",{className:\"grid\",style:{gridTemplateColumns:'1fr'},children:/*#__PURE__*/_jsx(AdminLogViewer,{onBack:()=>setMode('profile')})}):/*#__PURE__*/_jsxs(\"div\",{className:\"grid\",style:{gridTemplateColumns:'0.9fr 1.1fr'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"card\",style:{marginBottom:16},children:/*#__PURE__*/_jsxs(\"div\",{className:\"card__body\",style:{display:'flex',justifyContent:'space-between',alignItems:'center',gap:8,flexWrap:'wrap'},children:[/*#__PURE__*/_jsx(\"div\",{className:\"badge\",children:\"Qu\\u1EA3n tr\\u1ECB\"}),/*#__PURE__*/_jsx(\"button\",{className:\"button button--ghost\",onClick:()=>{setEditTarget('self');setMode('profile');},children:\"H\\u1ED3 s\\u01A1 c\\u1EE7a t\\xF4i\"}),/*#__PURE__*/_jsx(\"button\",{className:\"button button--ghost\",onClick:()=>setMode('logs'),children:\"\\uD83D\\uDCCA Logs\"})]})}),/*#__PURE__*/_jsx(AdminUserList,{refreshKey:listRefreshKey,onSelect:u=>{setSelectedUser(u);setEditTarget('selected');setMode('profile');},onDeleted:summary=>{setListRefreshKey(k=>k+1);if(selectedUser&&(summary===null||summary===void 0?void 0:summary.deleted)>0){setSelectedUser(null);setEditTarget('self');setMode('profile');}}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card__header\",children:editTarget==='self'?\"H\\u1ED3 s\\u01A1: \".concat(user.name):selectedUser?\"H\\u1ED3 s\\u01A1: \".concat(selectedUser.name):'H·ªì s∆°'}),/*#__PURE__*/_jsx(\"div\",{className:\"card__body\",children:editTarget==='self'?mode==='profile'?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ProfileView,{user:user}),/*#__PURE__*/_jsx(\"div\",{className:\"row\",style:{marginTop:12},children:/*#__PURE__*/_jsx(\"button\",{className:\"button\",onClick:()=>setMode('profile-edit'),children:\"S\\u1EEDa th\\xF4ng tin\"})})]}):/*#__PURE__*/_jsx(ProfileForm,{initialUser:user,allowSelfChangePassword:false,focusChangePassword:false,onSaved:async()=>{try{const res=await api.get('/auth/me');setUser(res.data);}catch(_unused2){}setMode('profile');}}):!selectedUser?/*#__PURE__*/_jsx(\"div\",{className:\"empty\",children:\"Ch\\u1ECDn m\\u1ED9t t\\xE0i kho\\u1EA3n \\u1EDF danh s\\xE1ch \\u0111\\u1EC3 xem/c\\u1EADp nh\\u1EADt\"}):mode==='profile'?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ProfileView,{user:selectedUser}),/*#__PURE__*/_jsxs(\"div\",{className:\"row\",style:{marginTop:12,display:'flex',gap:8},children:[/*#__PURE__*/_jsx(\"button\",{className:\"button\",onClick:()=>setMode('profile-edit'),children:\"S\\u1EEDa th\\xF4ng tin\"}),(selectedUser===null||selectedUser===void 0?void 0:selectedUser.role)!=='admin'&&/*#__PURE__*/_jsx(\"button\",{className:\"button button--danger\",onClick:async()=>{if(!selectedUser)return;const ok=await(confirm?confirm(\"X\\xF3a ng\\u01B0\\u1EDDi d\\xF9ng '\".concat(selectedUser.name,\"'? H\\xE0nh \\u0111\\u1ED9ng n\\xE0y kh\\xF4ng th\\u1EC3 ho\\xE0n t\\xE1c.\")):Promise.resolve(window.confirm(\"X\\xF3a ng\\u01B0\\u1EDDi d\\xF9ng '\".concat(selectedUser.name,\"'? H\\xE0nh \\u0111\\u1ED9ng n\\xE0y kh\\xF4ng th\\u1EC3 ho\\xE0n t\\xE1c.\"))));if(!ok)return;try{var _toast$success2;await api.delete(\"/users/\".concat(selectedUser._id));setSelectedUser(null);setListRefreshKey(k=>k+1);toast===null||toast===void 0?void 0:(_toast$success2=toast.success)===null||_toast$success2===void 0?void 0:_toast$success2.call(toast,'ƒê√£ x√≥a ng∆∞·ªùi d√πng');}catch(e){var _toast$error2,_e$response2,_e$response2$data;toast===null||toast===void 0?void 0:(_toast$error2=toast.error)===null||_toast$error2===void 0?void 0:_toast$error2.call(toast,(e===null||e===void 0?void 0:(_e$response2=e.response)===null||_e$response2===void 0?void 0:(_e$response2$data=_e$response2.data)===null||_e$response2$data===void 0?void 0:_e$response2$data.message)||'X√≥a th·∫•t b·∫°i');}},children:\"X\\xF3a ng\\u01B0\\u1EDDi d\\xF9ng\"})]})]}):/*#__PURE__*/_jsx(ProfileForm,{initialUser:selectedUser,isAdminEditing:true,userId:selectedUser._id,onSaved:async()=>{try{const res=await api.get(\"/users/\".concat(selectedUser._id));setSelectedUser(res.data);}catch(_unused3){}setMode('profile');}})})]})]}))]})]})]});}","map":{"version":3,"names":["useState","useEffect","useDispatch","logout","logoutAction","useLocation","useNavigate","api","UserList","AddUser","ProfileView","ProfileForm","AdminUserList","AdminLogViewer","HoverMenu","Register","Login","ForgotPassword","ResetPassword","ForgotPasswordLink","ResetPasswordByToken","ChangePasswordAdmin","AuthHeader","useToast","useConfirm","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","App","location","navigate","dispatch","reloadKey","setReloadKey","editUser","setEditUser","user","setUser","JSON","parse","localStorage","getItem","e","view","setView","resetToken","setResetToken","resetEmail","setResetEmail","selectedUser","setSelectedUser","mode","setMode","editTarget","setEditTarget","listRefreshKey","setListRefreshKey","pathname","needsAuth","replace","state","from","token","res","get","data","params","URLSearchParams","window","search","t","handleEdit","u","handleCancelEdit","handleAdded","k","handleLogout","removeItem","toast","confirm","handleDeleteSelf","ok","Promise","resolve","_toast$success","delete","success","call","_toast$error","_e$response","_e$response$data","error","response","message","handleLoggedIn","_location$state","path","role","className","children","onLogout","onEditProfile","onChangePassword","isChangePasswordMode","isProfileEditMode","onGoHome","onDeleteSelf","style","marginTop","padding","display","gap","flex","onLoggedIn","onForgot","justifyContent","onClick","onRegistered","onRequested","email","defaultEmail","onDone","defaultToken","gridTemplateColumns","initialUser","allowSelfChangePassword","focusChangePassword","onSaved","_unused","onBack","marginBottom","alignItems","flexWrap","refreshKey","onSelect","onDeleted","summary","deleted","concat","name","_unused2","_toast$success2","_id","_toast$error2","_e$response2","_e$response2$data","isAdminEditing","userId","_unused3"],"sources":["D:/New folder/Group2-Project-main/frontend/src/App.js"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport { useDispatch } from 'react-redux';\nimport { logout as logoutAction } from './store/authSlice';\nimport { useLocation, useNavigate } from 'react-router-dom';\nimport api from \"./lib/api\";\nimport UserList from \"./components/UserList\";\nimport AddUser from \"./components/AddUser\";\nimport ProfileView from \"./components/ProfileView\";\nimport ProfileForm from \"./components/ProfileForm\";\nimport AdminUserList from \"./components/AdminUserList\";\nimport AdminLogViewer from \"./components/AdminLogViewer\";\nimport HoverMenu from \"./components/HoverMenu\";\nimport Register from \"./components/Register\";\nimport Login from \"./components/Login\";\nimport ForgotPassword from \"./components/ForgotPassword\";\nimport ResetPassword from \"./components/ResetPassword\";\nimport ForgotPasswordLink from \"./components/ForgotPasswordLink\";\nimport ResetPasswordByToken from \"./components/ResetPasswordByToken\";\nimport ChangePasswordAdmin from \"./components/ChangePasswordAdmin\";\nimport AuthHeader from \"./components/AuthHeader\";\nimport { useToast } from \"./components/Toast\";\nimport { useConfirm } from \"./components/ConfirmDialog\";\n\nexport default function App() {\n  const location = useLocation();\n  const navigate = useNavigate();\n  const dispatch = useDispatch();\n  const [reloadKey, setReloadKey] = useState(0);\n  const [editUser, setEditUser] = useState(null);\n  const [user, setUser] = useState(() => {\n    try {\n      return JSON.parse(localStorage.getItem(\"auth_user\")) || null;\n    } catch (e) {\n      return null;\n    }\n  });\n  const [view, setView] = useState(user ? \"app\" : \"login\"); // 'app' | 'login' | 'register' | 'forgot' | 'reset' | 'forgot-link' | 'reset-link'\n  const [resetToken, setResetToken] = useState(\"\");\n  const [resetEmail, setResetEmail] = useState(\"\");\n  const [selectedUser, setSelectedUser] = useState(null); // for admin viewing others\n  const [mode, setMode] = useState('profile'); // 'profile' | 'profile-edit' | 'change-password' | 'logs'\n  const [editTarget, setEditTarget] = useState('self'); // 'self' | 'selected'\n  const [listRefreshKey, setListRefreshKey] = useState(0);\n\n  useEffect(() => {\n    if (user) setView(\"app\");\n  }, [user]);\n\n  // Route guarding inside App (in addition to ProtectedRoute)\n  useEffect(() => {\n    const pathname = location.pathname || '/';\n    const needsAuth = pathname === '/profile' || pathname === '/admin';\n    if (needsAuth && !user) {\n      navigate('/login', { replace: true, state: { from: pathname } });\n    }\n  }, [location.pathname, user, navigate]);\n\n  // On app mount, if token exists, verify and load user from /auth/me\n  useEffect(() => {\n    const token = localStorage.getItem(\"auth_token\");\n    if (!token) return;\n    (async () => {\n      try {\n        const res = await api.get('/auth/me');\n        setUser(res.data);\n        setView('app');\n      } catch (e) {\n        // invalid token handled by interceptor; ensure state reflects logged out\n        setUser(null);\n        setView('login');\n        navigate('/login', { replace: true });\n      }\n    })();\n  }, [navigate]);\n\n  // Detect reset token from URL to open reset-by-token view directly\n  useEffect(() => {\n    if (user) return;\n    const params = new URLSearchParams(window.location.search);\n    const t = params.get('resetToken') || params.get('token');\n    if (t) {\n      setResetToken(t);\n      setView('reset-link');\n    }\n  }, [user]);\n\n  const handleEdit = (u) => setEditUser(u);\n  const handleCancelEdit = () => setEditUser(null);\n  const handleAdded = () => { setReloadKey((k) => k + 1); setEditUser(null); };\n\n  const handleLogout = () => {\n    localStorage.removeItem(\"auth_token\");\n    localStorage.removeItem(\"auth_user\");\n    setUser(null);\n    setView(\"login\");\n    dispatch(logoutAction());\n    navigate('/login', { replace: true });\n  };\n\n  const toast = useToast?.() || null;\n  const confirm = useConfirm?.();\n  const handleDeleteSelf = async () => {\n  const ok = await (confirm ? confirm(\"B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a t√†i kho·∫£n? H√†nh ƒë·ªông n√†y kh√¥ng th·ªÉ ho√†n t√°c.\") : Promise.resolve(window.confirm(\"B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a t√†i kho·∫£n? H√†nh ƒë·ªông n√†y kh√¥ng th·ªÉ ho√†n t√°c.\")));\n    if (!ok) return;\n    try {\n      await api.delete('/auth/me');\n      toast?.success?.('ƒê√£ x√≥a t√†i kho·∫£n');\n      handleLogout();\n    } catch (e) {\n      toast?.error?.(e?.response?.data?.message || 'X√≥a t√†i kho·∫£n th·∫•t b·∫°i');\n    }\n  };\n\n  const handleLoggedIn = (u) => {\n    setUser(u);\n    setView(\"app\");\n    // Navigate based on role if current path is auth pages\n    const path = u?.role === 'admin' ? '/admin' : '/profile';\n    const from = location.state?.from;\n    navigate(from && from !== '/login' ? from : path, { replace: true });\n  };\n\n  return (\n    <div className=\"container\">\n      <header className=\"header\">\n        <h1>User Portal</h1>\n        <span className=\"badge\">MongoDB ¬∑ Express ¬∑ React</span>\n      </header>\n      {user && (\n        <HoverMenu \n          user={user} \n          onLogout={handleLogout} \n          onEditProfile={() => { setEditTarget('self'); setMode('profile-edit'); }}\n          onChangePassword={() => { setEditTarget('self'); setMode('change-password'); }}\n          isChangePasswordMode={user.role === 'admin' && mode === 'change-password'}\n          isProfileEditMode={user.role !== 'admin' && mode === 'profile-edit'}\n          onGoHome={() => { setMode('profile'); setEditTarget('self'); }}\n          onDeleteSelf={handleDeleteSelf}\n        />\n      )}\n\n      <div style={{ marginTop: 16 }}>\n        {!user && (\n          <div className=\"card\" style={{ padding: 18 }}>\n            <div style={{ display: 'flex', gap: 20 }}>\n              <div style={{ flex: 1 }}>\n                {view === \"login\" ? (\n                  <>\n                    <div className=\"card__header\">ƒêƒÉng nh·∫≠p</div>\n                    <div className=\"card__body\"><Login onLoggedIn={handleLoggedIn} onForgot={() => setView('forgot')} /></div>\n                    <div style={{ marginTop: 12, display: 'flex', justifyContent: 'center', gap: 8 }}>\n                      <button className=\"button button--ghost\" onClick={() => setView('register')}>T·∫°o t√†i kho·∫£n</button>\n                      <button className=\"button button--ghost\" onClick={() => setView('forgot')}>Qu√™n m·∫≠t kh·∫©u (OTP)</button>\n                      <button className=\"button button--ghost\" onClick={() => setView('forgot-link')}>Qu√™n m·∫≠t kh·∫©u (link)</button>\n                    </div>\n                  </>\n                ) : view === 'register' ? (\n                  <>\n                    <div className=\"card__header\">ƒêƒÉng k√Ω</div>\n                    <div className=\"card__body\"><Register onRegistered={() => setView('login')} /></div>\n                    <div style={{ marginTop: 12 }}>\n                      <button className=\"button button--ghost\" onClick={() => setView('login')}>ƒê√£ c√≥ t√†i kho·∫£n? ƒêƒÉng nh·∫≠p</button>\n                    </div>\n                  </>\n                ) : view === 'forgot' ? (\n                  <>\n                    <div className=\"card__header\">Qu√™n m·∫≠t kh·∫©u</div>\n                    <div className=\"card__body\">\n                      <ForgotPassword onRequested={(email) => { setResetEmail(email); setView('reset'); }} />\n                    </div>\n                    <div style={{ marginTop: 12 }}>\n                      <button className=\"button button--ghost\" onClick={() => setView('login')}>Quay l·∫°i ƒëƒÉng nh·∫≠p</button>\n                    </div>\n                  </>\n                ) : view === 'reset' ? (\n                  <>\n                    <div className=\"card__header\">Nh·∫≠p OTP v√† m·∫≠t kh·∫©u m·ªõi</div>\n                    <div className=\"card__body\">\n                      <ResetPassword defaultEmail={resetEmail} onDone={() => setView('login')} />\n                    </div>\n                    <div style={{ marginTop: 12 }}>\n                      <button className=\"button button--ghost\" onClick={() => setView('login')}>Quay l·∫°i ƒëƒÉng nh·∫≠p</button>\n                    </div>\n                  </>\n                ) : view === 'forgot-link' ? (\n                  <>\n                    <div className=\"card__header\">Qu√™n m·∫≠t kh·∫©u (nh·∫≠n link qua email)</div>\n                    <div className=\"card__body\">\n                      <ForgotPasswordLink onRequested={() => { /* stay here, user ki·ªÉm tra email */ }} />\n                    </div>\n                    <div style={{ marginTop: 12, display: 'flex', gap: 8 }}>\n                      <button className=\"button button--ghost\" onClick={() => setView('login')}>Quay l·∫°i ƒëƒÉng nh·∫≠p</button>\n                      <button className=\"button button--ghost\" onClick={() => setView('forgot')}>ƒê·ªïi sang OTP</button>\n                    </div>\n                  </>\n                ) : (\n                  <>\n                    <div className=\"card__header\">ƒê·∫∑t l·∫°i m·∫≠t kh·∫©u t·ª´ link</div>\n                    <div className=\"card__body\">\n                      <ResetPasswordByToken defaultToken={resetToken} onDone={() => setView('login')} />\n                    </div>\n                    <div style={{ marginTop: 12 }}>\n                      <button className=\"button button--ghost\" onClick={() => setView('login')}>Quay l·∫°i ƒëƒÉng nh·∫≠p</button>\n                    </div>\n                  </>\n                )}\n              </div>\n            </div>\n          </div>\n        )}\n\n        {user && (\n          <>\n            {/* Removed inline user header for cleaner look as requested */}\n\n            {/* Profile area for all users */}\n            {user.role !== 'admin' && (\n              <div className=\"grid\" style={{ gridTemplateColumns: '1fr' }}>\n                {mode === 'profile' ? (\n                  <div className=\"card\">\n                    <div className=\"card__header\">H·ªì s∆° c·ªßa t√¥i</div>\n                    <div className=\"card__body\">\n                      <ProfileView user={user} />\n                      <div className=\"empty\" style={{ marginTop: 12 }}>ƒê·ªÉ c·∫≠p nh·∫≠t th√¥ng tin, m·ªü menu b√™n ph·∫£i v√† ch·ªçn \"C·∫≠p nh·∫≠t th√¥ng tin\"</div>\n                    </div>\n                  </div>\n                ) : (\n                  <div className=\"card\">\n                    <div className=\"card__header\">C·∫≠p nh·∫≠t th√¥ng tin c√° nh√¢n</div>\n                    <div className=\"card__body\">\n                      <ProfileForm initialUser={user} allowSelfChangePassword focusChangePassword={false} onSaved={async () => {\n                        try {\n                          const res = await api.get('/auth/me');\n                          setUser(res.data);\n                        } catch {}\n                        setMode('profile');\n                      }} />\n                    </div>\n                  </div>\n                )}\n              </div>\n            )}\n\n            {user.role === 'admin' && (\n              mode === 'change-password' ? (\n                // Separate page: only the Change Password card, no account list\n                <div className=\"grid\" style={{ gridTemplateColumns: '1fr' }}>\n                  <ChangePasswordAdmin />\n                </div>\n              ) : mode === 'logs' ? (\n                // Separate page: Logs viewer\n                <div className=\"grid\" style={{ gridTemplateColumns: '1fr' }}>\n                  <AdminLogViewer onBack={() => setMode('profile')} />\n                </div>\n              ) : (\n                <div className=\"grid\" style={{ gridTemplateColumns: '0.9fr 1.1fr' }}>\n                  <div>\n                    <div className=\"card\" style={{ marginBottom: 16 }}>\n                      <div className=\"card__body\" style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', gap: 8, flexWrap: 'wrap' }}>\n                        <div className=\"badge\">Qu·∫£n tr·ªã</div>\n                        <button className=\"button button--ghost\" onClick={() => { setEditTarget('self'); setMode('profile'); }}>H·ªì s∆° c·ªßa t√¥i</button>\n                        <button className=\"button button--ghost\" onClick={() => setMode('logs')}>üìä Logs</button>\n                      </div>\n                    </div>\n                    <AdminUserList\n                      refreshKey={listRefreshKey}\n                      onSelect={(u) => { setSelectedUser(u); setEditTarget('selected'); setMode('profile'); }}\n                      onDeleted={(summary) => {\n                        setListRefreshKey(k => k + 1);\n                        if (selectedUser && summary?.deleted > 0) {\n                          setSelectedUser(null);\n                          setEditTarget('self');\n                          setMode('profile');\n                        }\n                      }}\n                    />\n                  </div>\n                  <div className=\"card\">\n                    <div className=\"card__header\">{editTarget === 'self' ? `H·ªì s∆°: ${user.name}` : (selectedUser ? `H·ªì s∆°: ${selectedUser.name}` : 'H·ªì s∆°')}</div>\n                    <div className=\"card__body\">\n                      {editTarget === 'self' ? (\n                        mode === 'profile' ? (\n                          <>\n                            <ProfileView user={user} />\n                            <div className=\"row\" style={{ marginTop: 12 }}>\n                              <button className=\"button\" onClick={() => setMode('profile-edit')}>S·ª≠a th√¥ng tin</button>\n                            </div>\n                          </>\n                        ) : (\n                          <ProfileForm initialUser={user} allowSelfChangePassword={false} focusChangePassword={false} onSaved={async () => {\n                            try {\n                              const res = await api.get('/auth/me');\n                              setUser(res.data);\n                            } catch {}\n                            setMode('profile');\n                          }} />\n                        )\n                      ) : (\n                        !selectedUser ? (\n                          <div className=\"empty\">Ch·ªçn m·ªôt t√†i kho·∫£n ·ªü danh s√°ch ƒë·ªÉ xem/c·∫≠p nh·∫≠t</div>\n                        ) : (\n                          mode === 'profile' ? (\n                            <>\n                              <ProfileView user={selectedUser} />\n                              <div className=\"row\" style={{ marginTop: 12, display: 'flex', gap: 8 }}>\n                                <button className=\"button\" onClick={() => setMode('profile-edit')}>S·ª≠a th√¥ng tin</button>\n                                {selectedUser?.role !== 'admin' && (\n                                  <button className=\"button button--danger\" onClick={async () => {\n                                    if (!selectedUser) return;\n                                    const ok = await (confirm ? confirm(`X√≥a ng∆∞·ªùi d√πng '${selectedUser.name}'? H√†nh ƒë·ªông n√†y kh√¥ng th·ªÉ ho√†n t√°c.`) : Promise.resolve(window.confirm(`X√≥a ng∆∞·ªùi d√πng '${selectedUser.name}'? H√†nh ƒë·ªông n√†y kh√¥ng th·ªÉ ho√†n t√°c.`)));\n                                    if (!ok) return;\n                                    try {\n                                      await api.delete(`/users/${selectedUser._id}`);\n                                      setSelectedUser(null);\n                                      setListRefreshKey(k => k + 1);\n                                      toast?.success?.('ƒê√£ x√≥a ng∆∞·ªùi d√πng');\n                                    } catch (e) {\n                                      toast?.error?.(e?.response?.data?.message || 'X√≥a th·∫•t b·∫°i');\n                                    }\n                                  }}>X√≥a ng∆∞·ªùi d√πng</button>\n                                )}\n                              </div>\n                            </>\n                          ) : (\n                            <ProfileForm initialUser={selectedUser} isAdminEditing userId={selectedUser._id} onSaved={async () => {\n                              try {\n                                const res = await api.get(`/users/${selectedUser._id}`);\n                                setSelectedUser(res.data);\n                              } catch {}\n                              setMode('profile');\n                            }} />\n                          )\n                        )\n                      )}\n                    </div>\n                  </div>\n                </div>\n              )\n            )}\n          </>\n  )}\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}